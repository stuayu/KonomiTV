import{d as B,q as s,s as _,x as D,z as x,c as S,a as i,b as m,B as N,o as k,_ as T}from"./index-CQ9TVK9F.js";import{B as H}from"./VPagination-HmQGxjeB.js";import{H as I,N as O}from"./Navigation-OHZsruh8.js";import{R as P,a as U}from"./ReservationList-kjoBNkFF.js";import{S as V}from"./SPHeaderBar-CMm0LIOD.js";import"./ssrBoot-CGfWNnEf.js";import"./VSwitch-BP9jhnpB.js";import"./VTextField-aDLm7uZ0.js";import"./VAvatar-DMdSlQzD.js";import"./VChip-cf8KEkhw.js";import"./VSelect-BQ0Dfuub.js";const z={class:"route-container"},A={class:"reservations-all-container-wrapper"},C={class:"reservations-all-container"},E=B({__name:"Reservations",setup(F){const t=x(),g=N(),c=s([]),p=s(0),o=s(1),n=s("asc"),l=s(!0),r=s([]),y=s();async function h(){if(r.value.length>0)return;l.value=!0;const e=await U.fetchReservations();e&&(r.value=e.reservations),l.value=!1}function u(){if(r.value.length===0){c.value=[],p.value=0;return}let e=[...r.value];n.value==="asc"?e.sort((v,d)=>new Date(v.program.start_time).getTime()-new Date(d.program.start_time).getTime()):e.sort((v,d)=>new Date(d.program.start_time).getTime()-new Date(v.program.start_time).getTime());const a=25,f=(o.value-1)*a,w=f+a;c.value=e.slice(f,w),p.value=e.length}async function q(e){o.value=e,await g.replace({query:{...t.query,page:e.toString()}})}async function R(e){n.value=e,o.value=1,await g.replace({query:{...t.query,order:e,page:"1"}})}function b(e){r.value=r.value.filter(a=>a.id!==e),u()}return _(()=>t.query,async e=>{if(e.page){const a=parseInt(String(e.page),10);Number.isFinite(a)&&a>0&&(o.value=a)}if(e.order){const a=String(e.order);(a==="asc"||a==="desc")&&(n.value=a)}u()},{deep:!0}),_(()=>r.value,()=>{u()},{deep:!0}),D(async()=>{t.query.page&&typeof t.query.page=="string"&&(o.value=parseInt(t.query.page,10)),t.query.order&&typeof t.query.order=="string"&&(n.value=t.query.order),await h(),u()}),(e,a)=>(k(),S("div",z,[i(I),m("main",null,[i(O),m("div",A,[i(V),m("div",C,[i(H,{crumbs:[{name:"ホーム",path:"/"},{name:"録画予約",path:"/reservations/"},{name:"録画予約一覧",path:"/reservations/all",disabled:!0}]}),i(P,{ref_key:"reservation_list",ref:y,title:"録画予約一覧",reservations:c.value,total:p.value,page:o.value,"sort-order":n.value,"is-loading":l.value,"show-back-button":!0,"show-empty-message":!l.value,"onUpdate:page":q,"onUpdate:sortOrder":R,onDelete:b},null,8,["reservations","total","page","sort-order","is-loading","show-empty-message"])])])])]))}}),Q=T(E,[["__scopeId","data-v-3938e85f"]]);export{Q as default};
